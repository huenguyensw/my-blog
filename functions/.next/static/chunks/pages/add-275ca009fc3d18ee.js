(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[753],{1068:(e,i,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/add",function(){return n(6967)}])},6967:(e,i,n)=>{"use strict";n.r(i),n.d(i,{default:()=>f});var t=n(7876),a=n(4232),r=n(9143),l=n(1951),s=n(7018),o=n(1084),d=n(7935),g=n(2232),c=n(405),u=n(5336),h=n(2317),p=n(2033),m=n(3256),j=n(4868),x=n(5684),v=n(8865),A=n(6631);let f=()=>{let[e,i]=(0,a.useState)({name:"",description:"",category:[],imageUrl:"",rating:0,ingredients:[],preparationTime:0,cookingTime:0,preservationMethods:[],relatedPosts:[],author:"",cookingSteps:[],recognization:[]}),[n,f]=(0,a.useState)(""),[y,b]=(0,a.useState)(null),[w,k]=(0,a.useState)(null),[P,S]=(0,a.useState)(!1),{user:T}=(0,a.useContext)(A.c),C=e=>{let{name:n,value:t}=e.target;i(e=>({...e,[n]:"category"===n&&"string"==typeof t?t.split(","):t}))},W=async n=>{if(n.preventDefault(),f("Submitting..."),!y){f("Please select an image file."),S(!0);return}let t=new FormData;t.append("file",y);try{let n=await fetch("/api/upload",{method:"POST",body:t});if(!n.ok)throw Error("Image upload failed");let a=await n.json(),r=null==a?void 0:a.imageUrl,l=await fetch("/api/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e.name,description:e.description,category:e.category,rating:e.rating,imageUrl:r,preparationTime:e.preparationTime,cookingTime:e.cookingTime,preservationMethods:e.preservationMethods,relatedPosts:e.relatedPosts,ingredients:e.ingredients,recognization:e.recognization,cookingSteps:e.cookingSteps,createdAt:new Date,updatedAt:new Date,author:null==T?void 0:T._id})}),s=await l.json();console.log("API Response:",e),l.ok?(f("Blog added successfully!"),S(!0),i({name:"",description:"",category:[],imageUrl:"",rating:0,ingredients:[],preparationTime:0,cookingTime:0,preservationMethods:[],relatedPosts:[],author:"",cookingSteps:[],recognization:[]}),k(null),b(null),window.location.href="/profile?isLoginPage=false"):(f(s.message||"Error adding blog."),S(!0))}catch(e){f("Something went wrong."),S(!0),console.error("Error:",e)}};return(0,t.jsxs)(r.A,{maxWidth:"sm",children:[(0,t.jsxs)(l.A,{elevation:3,sx:{padding:3,marginTop:10,marginBottom:10},children:[(0,t.jsx)(s.A,{variant:"h5",gutterBottom:!0,children:"L\xe4gg till en ny blogg"}),(0,t.jsx)("form",{onSubmit:W,children:(0,t.jsxs)(o.A,{container:!0,spacing:2,sx:{display:"flex",flexDirection:"column",rowGap:2,mt:3},children:[(0,t.jsx)(o.A,{children:(0,t.jsx)(d.A,{fullWidth:!0,label:"Namn",name:"name",value:e.name,onChange:C,required:!0})}),(0,t.jsx)(o.A,{children:(0,t.jsx)(d.A,{fullWidth:!0,multiline:!0,rows:3,label:"Beskrivning",name:"description",value:e.description,onChange:C,required:!0})}),(0,t.jsx)(o.A,{children:(0,t.jsxs)(g.A,{fullWidth:!0,required:!0,children:[(0,t.jsx)(c.A,{children:"Kategori"}),(0,t.jsx)(u.A,{name:"category",value:e.category,onChange:e=>C(e),multiple:!0,renderValue:e=>e.join(", "),children:["Matlagning","Svampar","Konservering"].map(i=>(0,t.jsxs)(h.A,{value:i,children:[(0,t.jsx)(p.A,{checked:e.category.includes(i)}),(0,t.jsx)(m.A,{primary:i})]},i))})]})}),(0,t.jsx)(o.A,{children:(0,t.jsx)(d.A,{fullWidth:!0,label:"F\xf6rfattare",name:"author",value:null==T?void 0:T._id,required:!0})}),e.category&&e.category.includes("Matlagning")&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.A,{children:(0,t.jsx)(d.A,{fullWidth:!0,label:"Ingredienser",name:"ingredients",value:e.ingredients.join(", "),onChange:n=>i({...e,ingredients:n.target.value.split(", ")}),required:!0})}),(0,t.jsx)(o.A,{children:(0,t.jsx)(d.A,{fullWidth:!0,label:"F\xf6rberedelseltid",name:"preparationTime",value:e.preparationTime,onChange:C,required:!0})}),(0,t.jsx)(o.A,{children:(0,t.jsx)(d.A,{fullWidth:!0,label:"Tillagningstid",name:"cookingTime",value:e.cookingTime,onChange:C,required:!0})}),(0,t.jsx)(o.A,{children:(0,t.jsx)(d.A,{fullWidth:!0,label:"Relaterade inl\xe4gg",name:"relatedPosts",value:e.relatedPosts.join(", "),onChange:n=>i({...e,relatedPosts:n.target.value.split(", ")})})}),(0,t.jsx)(o.A,{children:(0,t.jsx)(d.A,{fullWidth:!0,label:"Tillagningssteg",name:"cookingSteps",value:e.cookingSteps.join(". "),onChange:n=>i({...e,cookingSteps:n.target.value.split(". ")})})})]}),e.category&&e.category.includes("Svampar")&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.A,{children:(0,t.jsx)(d.A,{fullWidth:!0,label:"Relaterade inl\xe4gg",name:"relatedPosts",value:e.relatedPosts.join(", "),onChange:n=>i({...e,relatedPosts:n.target.value.split(", ")})})}),(0,t.jsx)(o.A,{children:(0,t.jsx)(d.A,{fullWidth:!0,label:"Svampigenk\xe4nning",name:"recognization",value:e.recognization.join(". "),onChange:n=>i({...e,recognization:n.target.value.split(". ")})})})]}),e.category&&e.category.includes("Konservering")&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.A,{children:(0,t.jsx)(d.A,{fullWidth:!0,label:"Konserveringsmetoder",name:"preservationMethods",value:e.preservationMethods.join(". "),onChange:n=>i({...e,preservationMethods:n.target.value.split(". ")})})}),(0,t.jsx)(o.A,{children:(0,t.jsx)(d.A,{fullWidth:!0,label:"Relaterade inl\xe4gg",name:"relatedPosts",value:e.relatedPosts.join(", "),onChange:n=>i({...e,relatedPosts:n.target.value.split(", ")})})})]}),(0,t.jsx)(o.A,{children:(0,t.jsx)(d.A,{fullWidth:!0,label:"Rating",name:"rating",value:e.rating,onChange:C,required:!0})}),(0,t.jsx)(o.A,{children:(0,t.jsxs)(j.A,{variant:"contained",component:"label",fullWidth:!0,children:["Ladda upp bild",(0,t.jsx)("input",{type:"file",hidden:!0,accept:"image/*",onChange:e=>{if(e.target.files&&e.target.files[0]){let i=e.target.files[0];b(i),k(URL.createObjectURL(i))}}})]})}),w&&(0,t.jsxs)(o.A,{children:[(0,t.jsx)(s.A,{variant:"body2",children:"Preview:"}),(0,t.jsx)("img",{src:w,alt:"Preview",style:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"8px"}})]}),(0,t.jsx)(o.A,{children:(0,t.jsx)(j.A,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,children:"L\xe4gg till blogg"})})]})})]}),(0,t.jsx)(x.A,{open:P,autoHideDuration:3e3,onClose:()=>S(!1),children:(0,t.jsx)(v.A,{severity:n.includes("successfully")?"success":"error",children:n})})]})}}},e=>{var i=i=>e(e.s=i);e.O(0,[455,980,521,636,593,792],()=>i(1068)),_N_E=e.O()}]);