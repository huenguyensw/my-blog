"use strict";(()=>{var e={};e.id=88,e.ids=[88],e.modules={3056:(e,r,t)=>{t.d(r,{A:()=>s});var n=t(6037);let a=new(t.n(n)()).Schema({firstName:{type:String,required:!0},lastName:{type:String,required:!0},email:{type:String,required:!0},userName:{type:String,required:!0},password:{type:String,required:!0},imageUrl:{type:String,required:!0},favorites:{type:[String],default:[]}}),s=n.models.User||(0,n.model)("User",a)},3459:(e,r,t)=>{t.r(r),t.d(r,{config:()=>c,default:()=>f,routeModule:()=>g});var n={};t.r(n),t.d(n,{default:()=>m});var a=t(3480),s=t(8667),i=t(6435),o=t(6810),d=t(3056),u=t(5486),l=t.n(u);async function m(e,r){if("POST"===e.method)try{let{firstName:t,lastName:n,email:a,imageUrl:s,userName:i,password:u}=e.body;if(!t||!n||!a||!s||!i||!u)return r.status(400).json({message:"Obligatoriska f\xe4lt saknas"});if(await (0,o.X)(),await d.A.findOne({email:a}))return r.status(409).json({message:"E-postadressen \xe4r redan registrerad"});if(await d.A.findOne({userName:i}))return r.status(409).json({message:"Anv\xe4ndarnamnet \xe4r redan taget"});let m=await l().genSalt(10),f=await l().hash(e.body.password,m),c=new d.A({firstName:e.body.firstName,lastName:e.body.lastName,email:e.body.email,imageUrl:e.body.imageUrl,userName:e.body.userName,password:f,favorites:[]});await c.save(),r.status(201).json({message:"Registreringen lyckades!",user:c})}catch(e){console.error("API Error:",e),r.status(500).json({message:"Internt serverfel",error:e})}else r.status(405).json({message:"Metod ej till\xe5ten"})}let f=(0,i.M)(n,"default"),c=(0,i.M)(n,"config"),g=new a.PagesAPIRouteModule({definition:{kind:s.A.PAGES_API,page:"/api/register",pathname:"/api/register",bundlePath:"",filename:""},userland:n})},3480:(e,r,t)=>{e.exports=t(5600)},5486:e=>{e.exports=require("bcrypt")},5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6037:e=>{e.exports=require("mongoose")},6435:(e,r)=>{Object.defineProperty(r,"M",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},6810:(e,r,t)=>{t.d(r,{X:()=>s});var n=t(6037),a=t.n(n);if(!process.env.DB_URL)throw Error("⚠️ MongoDB URI is not defined in environment variables.");async function s(){if(!(a().connection.readyState>=1))try{await a().connect(process.env.DB_URL,{dbName:"mushroomdb"}),console.log("✅ Connected to MongoDB")}catch(e){console.error("❌ MongoDB Connection Error:",e),process.exit(1)}}},8667:(e,r)=>{Object.defineProperty(r,"A",{enumerable:!0,get:function(){return t}});var t=function(e){return e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE",e}({})}};var r=require("../../webpack-api-runtime.js");r.C(e);var t=r(r.s=3459);module.exports=t})();